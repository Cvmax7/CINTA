# Concrete Introduction to Number Theory and Algebra

[TOC]

## 第一章 整数与二进制

- 算法考虑以下三个关键要素：**正确性、效率、优化**

==简单乘法（递归版）==
$$
a\cdot b = \begin{cases}2(a\cdot \lfloor b/2\rfloor) & 如果b是偶数 \\
a+2(a\cdot \lfloor b/2 \rfloor) & 如果b是奇数
\end {cases}
$$

```c++
int multiply(int a, int b)
{
	if (b == 0) return 0;
	if ((b & 1) == 0) return 2 * multiply(a, b / 2); //如果b是偶数
	else return 2 * multiply(a, b / 2) + a; //如果b是奇数
}
```

==简单乘法（迭代版）==

```c++
int multiply(int a, int b)
{
	if (b == 0) return 0;
	int res = 0;
	while (b > 0)
	{
		if (b & 1) res += a; //如果b的末位bit为1，则加上
		b >>= 1; //b右移一位
		a <<= 1; //计算a*2^i
	}
	return res;
}
```

==定理1.1 除法算法==

- 对任意给定的整数$a$和$b$，其中$b>0$，存在唯一的整数对$q$(商)和$r$(余数)使得，
  $$
  a=qb+r
  $$
  且$0\leq r <b$

==公理1.1 良序原则==

- 自然数的非空子集必然存在一个最小元素。

==命题1.1 整除性==

- 设$a,b,c \in Z$，如果$a|b,b|c$，则$a|c$。
- 如果$c|a,c|b$，则对任意$m,n\in Z$，有$c|(ma+nb)$。

==定义1.1 素数与合数==

- 若$p \in Z$且$p>1$。如果整除$p$的正整数只有$1$和$p$自己本身，则称$p$为素数。如果整数$n>1$不是素数，则称之为合数。

==简单除法==

```python
def divide(a, b):
    if a == 0:
        return 0, 0
    q, r = divide(a/2, b)
    q, r = 2 * q, 2 * r
    if a & 1:
        r = r + 1
    if r >= b:
        r, q = r - b, q + 1
    return q, r
```



## 第二章 欧几里得算法

$$
\star\begin{cases}gcd&(欧几里得算法)\\
bgcd & (二进制欧几里得算法)\\
egcd & (扩展欧几里得算法)
\end{cases}
$$

==定理2.1 欧几里得算法==

- 给定两个整数$a,b$，设$a\geq b$，则$a$和$b$的最大公因子等于$b$和$a\ mod\ b$的最大公因子。即
  $$
  gcd(a,b)=gcd(b,a\ mod\ b)
  $$
  其中，$a\ mod\ b$表示用$a$除以$b$所得到的余数$r$。

------

- 对任意两个正整数$a$和$b$，有$gcd(2^a -1,2^b-1)=2^{gcd(a,b)}-1$​。

------

==**欧几里得算法$(gcd)$**==

**1.递归版**

```c++
int gcd(int a, int b)
{
	if (b == 0) return a;
	else return gcd(b, a % b);
}
```

**时间复杂度:**$O(log(min\{a,b\}))$



2.**迭代版**

```c++
int gcd(int a, int b)
{
	while (b)
	{
		int temp = b;
		b = a % b;
		a = temp;
	}
	return a;
}
```

**时间复杂度：**$O(log(min\{a,b\}))$

------

==引理2.1==

- 如果$a\geq b$，则$(a\ mod\ b) < a/2$

==定理2.2 $Bezout$定理==

- 设$a$和$b$为**非零整数**，存在整数$r$和$s$使得：
  $$
  gcd(a,b)=ar+bs
  $$
  而且，**$a$与$b$的最大公因子是惟一的***。称$r$和$s$为**$Bezout$系数**。

------

==**扩展欧几里得算法$(egcd)$**==

**1.迭代版**

```c++
struct Bezout
{
	int r; 
	int s; //r、s为Bezout系数
	int d; //d为gcd(a,b)
};
Bezout egcd(int a, int b)
{
	Bezout res;
	int r0 = 1, r1 = 0, s0 = 0, s1 = 01, q; //初始化
	while (b)
	{
		q = a / b;
		//以下计算gcd(a,b)
		int temp = a % b;
		a = b;
		b = temp;
		//以下计算Bezout系数
		int tr = r0;
		int ts = s0;
		r0 = r1;
		r1 = tr - q * r1;
		s0 = s1;
		s1 = ts - q * s1;
	}
	res.r = r0;
	res.s = s0;
	res.d = a;
	return res;
}
```

**时间复杂度：**$O(log(min\{a,b\}))$



**2.递归版**

```c++
struct Bezout
{
	int r; 
	int s; //r、s为Bezout系数
	int d; //d为gcd(a,b)
};
Bezout egcd(int a, int b)
{
	Bezout res;
	if (b == 0)
	{
		res.r = 1;
		res.s = 0;
		res.d = a;
		return res;
	}
	res = egcd(b, a % b);
	int temp = res.r;
	res.r = res.s;
	res.s = temp - a / b * res.r;
	return res;
}
```

**时间复杂度：**$O(log(min\{a,b\}))$

> **$egcd$算法的效率与$gcd$算法效率一样，时间复杂度都为：$O(log(min\{a,b\}))$**

## 第三章 同余与模运算

==命题3.1==

- 如果$a_1\equiv b_1 \pmod m$而且$a_2\equiv b_2 \pmod m$，则
  $$
  a_1\pm a_2\equiv b_1 \pm b_2 \pmod m\  且\ a_1a_2\equiv b_1b_2 \pmod m
  $$

- 

==命题3.2 **消去律**==

- 设$a,b,c\in Z,m$是一个正整数。如果$gcd(c,m) = 1$，且$ac\equiv bc \pmod m$，则$a\equiv b \pmod m$
  - $cc^{-1}\equiv 1 \pmod m$
  - $acc^{-1} \equiv  bcc^{-1} \pmod m$
  - $a\equiv b \pmod m$

==命题3.4==

- **同余是一种等价关系**。
- **等价类**: 如果有一种等价关系定义在集合$S$上，则该等价关系会把集合$S$划分为不相交的子集，这些子集就称为等价类。
  - 模$m$的同余关系把$\Z$划分为$m$个等价类
- **同余类、剩余类**：$[a]_m$，即所有模$m$余$a$的整数形成的集合
- *$\Z / m\Z$*是**模$m$同余类的集合**，$\Z / m\Z = \{[0]_m,[1]_m,\dots [m-1]_m\}$，其中共有$m$个元素
- **代表元**：同余类$[a]_m$中的最小非负元素。
- **模$m$的最小剩余系**: $\Z / m\Z$的所有最小非负代表元的集合$\{0,1,2,\dots,m-1\}$
- **模$m$的完全剩余系**：任意$m$个整数的集合，如果其中任意两个元素都不模$m$同余，则称之为模$m$的完全剩余系。
  - e.g. $m=7$，则模$m$下
    - 最小剩余系: $\{0,1,2,3,4,5,6\}$
    - **一个**完全剩余系: $\{14,8,23,46,61,13\}$

==命题3.5==

- 如果$[a_1]_m\equiv [a_2]_m \pmod m$而且$[b_1]_m\equiv [b_2]_m \pmod m$，则
  $$
  [a_1\pm b_1]_m= [a_2 \pm b_2]_m \  且\ [a_1b_1]_m= [a_2b_2]_m
  $$

- 



==**模指数运算（快速幂）**==

**1.递归版：**

- 计算$x^y\ mod\ m$

$$
x^y= \begin{cases} (x^{\lfloor {y/2} \rfloor})^2,& \text{如果y是偶数} \\ x·(x^{\lfloor {y/2} \rfloor})^2, & \text{如果y是奇数} \end{cases}
$$

**时间复杂度：$O(log(y))$**

```c++
//模指数运算递归算法
int power(int x, int y, int p)
{
	if (y == 0) return 1;
	int z = power(x, y / 2, p);
	if (y & 1) //如果y是奇数
	{
		return (x * z * z) % p;
	}
	else
	{
		return (z * z) % p;
	}
}
```



**2.迭代版：**

- 计算$x^y\ mod\ m$
  - 先把$y$二进制展开
  - 再将$x^y$变形为：$x^y = \prod _{i = 0} ^{n-1} x^{y_i2^i}$
  - 若$y_i=1$，则将$x^{y_i2^i}$乘到最终res中

**时间复杂度：$O(log(y))$**

```c++
//模指数运算迭代算法
int power(int x, int y, int p)
{
	int res = 1;
	while (y > 0)
	{
		if ((y & 1) == 1) res = (res * x) % p; //如果y的末位为1，则把该值乘进最终结果
		y /= 2; //y右移
		x = (x * x) % p; //计算x^{2^i}
	}
	return res;
}
```



## 第四章 费尔马小定理和欧拉定理

==定理4.1 **费尔马小定理**==

- 设$p$是素数，设$a$为任意整数，且$a\not \equiv 0 \pmod p$，则
  $$
  a^{p-1}\equiv 1 \pmod p
  $$

- e.g. compute $3^{2019}\ mod\ 23$
  - 根据**Fermat小定理**：原式$=3^{91*(23-1)+17}\ mod \ 23 = 3^{17} mod\ 23$
  - 用**快速幂**：$3^2 \equiv  9 \pmod {23}$
  - $3^4 \equiv 9*9\pmod {23} \equiv 12\pmod {23}$
  - $3^8 \equiv 12*12\pmod {23} \equiv 6\pmod {23}$
  - $3^{16} \equiv 13 \pmod {23}$
  - $3^{17} \equiv 3*13 \pmod {23} \equiv 16 \pmod {23}$

------

==定义4.1 欧拉$Phi$函数==

- 欧拉$$Phi$$函数$\phi$对任意正整数$n$，返回$1$到$n$之间且与$n$**互素**的整数的**个数**，即：
  $$
  \phi(n) = |\{b:1\leq b < n\ 且\ gcd(b,n) = 1\}|
  $$

- 

==定理4.2 **欧拉定理**==

- 设$n$和$a$为正整数，且**$gcd(a,n) = 1$**，则：
  $$
  a^{\phi(n)} \equiv 1\pmod n
  $$

==命题4.1 **欧拉$$Phi$$函数性质**==

- 如果$p$是素数，则

  - $\phi(p) = p-1$

  - $\phi(p^k) = p^k - p^{k-1}$

==引理4.2==

- 对任意$a\in \Z$，如果$gcd(a,n) = 1$且$gcd(a,m) = 1$，则$gcd(a,mn)=1$。

==定理4.3 **欧拉$Phi$函数公式**(**欧拉Phi函数也被称为积性函数**)==

- 设$m$和$n$是**互素**的正整数，则$\phi(mn) = \phi(m)\phi(n)$。

==推论4.1==

- 设$m$为正整数，且将其表达为素数指数的乘积（**惟一分解定理**)，即$m=p_1^{a_1}p_2^{a_2}\dots p_k^{a_k}$，其中所有的$p_i$都是素数。则
  $$
  \phi(m)=\phi(p_1^{a_1})\phi(p_2^{a_2})\dots \phi(p_k^{a_k})
  $$

==定理4.4==

- 设$m$为正整数，且将其表达为素数指数的乘积（**惟一分解定理**），即$m=p_1^{a_1}p_2^{a_2}\dots p_k^{a_k}$，其中所有的$p_i$都是素数。则
  $$
  \phi(m)=m(1-\dfrac{1}{p_1})(1-\dfrac{1}{p_2})\dots (1-\dfrac{1}{p_k})
  $$

  - 证明：联立$\phi(m)=\phi(p_1^{a_1})\phi(p_2^{a_2})\dots \phi(p_k^{a_k})$与$\phi(p^k) = p^k - p^{k-1}$即可

## 第六章 群与子群

==说明==

- $Z_n=\{0,1,2,\dots n-1\}$是**模$n$操作下的加法群**，$Z_p^*$是模$p$（$p$为素数)操作下的乘法群。
- 而在模$n$的乘法操作下$(Z_n,×)$不是群（因为有0）
- 而$Z_n^* = \{a\in [1,n-1]且gcd(a,n)=1\}$在模$n$的乘法下成群。（把0去掉了）

==定义6.1 群==

- 群是集合$G$以及在其元素上所定义的操作符·，并满足以下群公理：
  - **封闭性**：$\forall a,b \in G,\ \ a·b\in G$
  - **结合律**：$$(a·b)·c=a·(b·c)$$
  - **存在单位元**：$\exists e\in G,\ \ e·a=a·e=a$
  - **存在逆元**：$\exists a^{-1}\in G, \ \ a·a^{-1}=e=a^{-1}·a$

- 如果对任意$a,b\in G$，满足$a·b=b·a$，则群$G$被称为**阿贝尔群或交换群**

==命题6.1 单位元唯一性==

==命题6.2 逆元唯一性==

==命题6.3==

- 设$G$为群，任取$a,b\in G$，则$(ab)^{-1}=b^{-1}a^{-1}$

==命题6.4==

- 设$G$为群，对所有群员$g\in G$，$(g^{-1})^{-1}=g$

==命题6.6==

- 群满足消去律（注意区分左消去律和右消去律）

==定义6.2 单射、满射、双射==

- 给定映射$\phi:A\rightarrow B$
  - 单射：对任意$\phi(x_1)=\phi(x_2)$，都有$x_1=x_2$，则称映射$\phi$为单射。
  - 满射：对任意$y\in B$，都存在$x\in A$使得$\phi(x)=y$
  - 双射：单射和满射同时满足

==命题6.7 群的一些性质==

- 设$G$是群，$\forall a,b\in G$，有：
  - $\forall m,n\in Z, g^mg^n = g^{m+n}$
  - $\forall m,n\in Z, (g^m)^n = g^{mn}$
  - $\forall n\in Z, (gh)^n = (h^{-1}g^{-1})^{-n}$，若$G$是阿贝尔群，则$(gh)^n=g^nh^n$

==定义6.3 阶==

- **群的阶**：群元素的个数，$|G|=n$
- **元素的阶**：对于$g\in G$，存在最小正整数$m$使得$g^m=e$，此时$m$为元素的阶，记为$ord(g)=m$
- 若群元素个数为无穷多个，则群的阶称为无穷阶
- 若不存在元素的阶，则称元素$g$有无穷阶

==定义6.4 子群==

- 设$G$为群。若$H$是$G$的子集，且$H$在群$G$的操作符上也满足群公理，则$H$被称为$G$的子群，记为$H\leq G$。
- 对于任意群$G$，存在一个平凡子群$\{e\}$。
- 欲证明：群$G$非空子集$H$是$G$的子群，考虑到群中单位元的唯一性、逆元的唯一性，而且$H$的元素必然继承了群$G$的结合律，那么检查$H$中的元素是否满足群公理时，检查条件可以简化。

==命题6.8 - 6.10 证明子群的三个方法==

- 群$G$的非空子集$H$是$G$的子群，当且仅当$H$同时满足以下条件：
  - 若$a,b\in H$，则$a,b\in H$
  - 若$a\in H$，则$a^{-1}\in H$
- 群$G$的非空子集$H$是$G$的子群，当且仅当对任意$a,b\in H , ab^{-1} \in H$
- 有限群$G$的非空子集$H$是$G$的子群，当且仅当$H$中的元素在群$G$的操作下满足封闭性。
  - 证明：$\Leftarrow:$对任意$a\in H$，迭代计算产生序列$a,a^2,a^3,\dots$。因为$H$的封闭性和有限性，必然存在$i,j \in N,s.t.\ a^i = a^j$，不妨假设$i<j$，则必有$t=j-i=0\in N,s.t. a^t = e$，故非空子集$H$中含有单位元$e$，而$a^{t-1}$即为$a$的逆元，故非空子集$H$满足群公理，是有限群$G$的子群，证毕。

==群元素的中心化子和群的中心==

- 中心化子：给定任意群元$a\in G$，定义与$a$的操作满足交换律的群元集合为
  $$
  C(a)=\{g\in G:ag=ga\}
  $$
  此时$C(a)$被称为$a$的中心化子。**$C(a)$是$G$的子群**

- 群的中心：在群操作上与所有群元素都满足交换律的元素的集合。
  $$
  Z(G)=\{g\in G:gx=xg,\forall x\in  G\}
  $$
  此时$Z(G)$被称为群$G$的中心。**$Z(G)$是$G$的子群**

- 群$G$的中心即为**所有群元素的中心化子**的**交集**。

==一个证明==

- 对任意给定的群$G$，及其子群$H$和元素$a\in G$，定义如下集合：
  $$
  a^{-1}\H a=\{a^{-1}ha:\forall h \in \H\}
  $$
  也是群$G$的子群。

  

## 第七章 循环群

循环群：**所有的群元素**都能被**特定的元素**计算出来（或者**生成**出来）

==命题7.1==

- 设$G$是群，$\forall g \in G$。则集合
  $$
  <g>=\{g^k:k\in \Z\}
  $$

是$G$的子群。称$<g>$为**由$g$生成的循环群**，称$g$为**群的生成元**。而且，$<g>$是群$G$中包含元素$g$的最小子群。

- 对于有限循环群而言，群的生成元就是**阶等于群阶的群元素**$(满足ord(g)=|G|，则g是群G的生成元)$

==命题7.2==

- 所有的循环群都是阿贝尔群。
  - Prove：设$G=<g>$是循环群，任取$a,b\in G$且$i,j\in Z$，必然有：$a=g^i,b=g^j$，则$ab=g^ig^j=g^{i+j}=g^jg^i=ba$，故$G$是阿贝尔群。

==命题7.3==

- 循环群$G=<g>$的每一个子群都是循环群。

==定义7.1 原根==

- 设$a$和$n$是互素的正整数。$a$模$n$的阶定义为最小整数$e\geq 1$使得$a^e\equiv 1 \pmod n$。如果$a$模$n$的阶等于模$n$下最大可能的阶，则称$a$是模$n$的原根。
  - 即**元素的阶=模$n$下最大可能的阶$(\phi(n))$**，则称$a$是模$n$的原根。
  - $a^{\phi(n)} \equiv 1 \pmod n$

e.g. 4模11的阶是5，而2和3模11的阶是10；模11下的最大可能阶为$\phi(11)=10$，故2、3为模11的原根。使用群的语言则称，$Z_{11}^*是由生成元2或3生成的循环群$。

==定理7.1 原根定理==

- 对每一个素数$p$都有模$p$的原根，且恰有$\phi(p-1)$个模$p$原根。

==定理7.2 广义原根定理==

- 如果$n\in Z$形如$2、4、p^e$和$2p^e$，对所有素数$p>2$和所有正整数$e$，则$Z_n^*$是循环群。

==命题7.4==

- 任取正整数$n$，设$G=<g>$是阶为$n$的循环群，则$g^k = e$当且仅当$n$整除$k$。

  - prove：$\Rightarrow:g^k=e$，根据除法算法，存在$q、r\in Z$，使得$k=qn+r$，则$g^{qn}g^r=e$

    则$(g^n)^qg^r=eg^r=e$，故$g^r=e$，由于$0\leq r< n$,**$n$是使得$g^n=e$的最小正整数**，故r只能取0。即$n$整除$k$证毕。

  - prove:$\Leftarrow:$由于$n$整除$k$，必存在唯一的$q\in Z\ s.t.\ k=nq$，从而$g^k=g^{nq}=(g^n)^q=e$

==命题7.5==

- 设群$G=<g>$是阶为$n$的循环群。如果$h=g^k$，则$h$的阶为$n/d$，其中$d=gcd(k,n)$。

  - 即证：$m=n/d$是使得$h^m=g^{km}=e$成立的最小正整数

  - 由于$g^{km}=e$，故$n|km$，由于$d=gcd(k,n)$，故有：$n/d|(k/d)m$，由于$n/d与g/d$互素，故有：

    $n/d|m$，故$m$最小为$n/d$。证毕。

------

**题型：**

- **在知道某个元是生成元时，可以验证另一个元是不是生成元。**

  - 若知道$G=<g>$的生成元$g$，要判断**群内元素**$h$是否为$G$的生成元，**我们需找到$g$操作多少次到$h$，**

    **记为$g^k=h$**，由命题可知，**$h$的阶为$n/d$，其中$d=gcd(k,n)$**。

    - 若$d=1$，说明$h$的阶为$n$，**$h$的阶等于群$G$的阶**，故$h$为生成元。
    - 若$d\neq 1$，说明$h$的阶不为$n$，故$h$不是生成元。

------

==推论7.1==

- 设群$G=<g>$是阶为$n$的循环群，则群$G$中恰有$\phi(n)$个生成元。
  - $g^k = h$，若$h$为生成元，则$d=gcd(k,n)=1$，小于$n$且与$n$互素的$k$的个数为$\phi(n)$个。
  - 故有$\phi(n)$个生成元

==推论7.2==

- 设群$G=<g>$是阶为$p$的循环群，$p$是素数，则$G$中的元素除了$e$之外都是生成元。

  - **素数阶循环群的元素中，除了单位元外的都是生成元。**

  - prove:任取$h=g^k \in G$，$h$的阶为$p/d$，其中$d=gcd(k,p)$，由于$p$为素数，故当$k\neq 1$，即当

    $g\neq e$时，对于所有$k\in [2,p-1]$，所对应的$h$的阶都为$p$，是生成元。证毕。

==推论7.3==

- 设群$G=<g>$是阶为$n$的循环群，则群中任意元素$h$的阶必整除$n$。

==寻找生成元==

- 根据原根定理，**给定一个素数$p$,$Z_p^*$是循环群，即必有至少一个生成元。**
  - prove：根据Fermat小定理：对于任意正整数$a$,$a^{p-1}\equiv 1 \pmod p$，且$a\not \equiv 0 \pmod p$
  - 而$Z_p^*$的阶为$p-1$，故必有至少一个生成元$a$落在$Z_p^*$中。

==原根判定算法==

给定一个素数$p$和一个正整数$a$，能否高效地判定$a$是否是模$p$的原根？

- 算法思路：穷举$p-1$的所有素因子$p_i$，计算$a^{(p-1)/p_i}\ mod\ p$并进行判断。
  - 若$a^{(p-1)/p_i}\ mod\ p=1$则返回$False$
  - 若对于$p-1$的所有素因子$p_i$都没有返回$False$，则返回$True$，说明$p-1$是元素$a$的最小正整数阶，进而说明$a$是模$p$的原根。

```python
import math
import gmpy2
# 求n的所有素因子
def prime_fators_list(n):
    list=[]
    for i in range(2, int(math.sqrt(n))+1):
        if n % i == 0 and gmpy2.is_prime(i):
            list.append(i)
    return list
# 原根判定算法
def is_primitive_root(a, p):
    flist = prime_fators_list(p-1) # 求p-1的所有素因子
    for f in flist:
        if pow(a, (p-1)//f, p) == 1:
            return False
    return True
```

- 时间复杂度：
  - 假设$p-1$有$k$个素因子，则时间复杂度为$O(n \cdot (\log{n})^3 + k \cdot \log{p})$



## 第八章 陪集与拉格朗日定理

- 选取一个群元素$a\in Z_p^*$，对群$Z_p^*$中的每一个元素都乘上$a$，得到一个“新”的集合。这种操作被称为**元素$a$作用于群$Z_p^{*}$** 。

![4bc6335ae256609b185fd978508b45d](D:\WeChat Files\wxid_6o0uvsbjr4sb12\FileStorage\Temp\4bc6335ae256609b185fd978508b45d.jpg)

==定义8.1 陪集==

- 设$G$是群，$\H$是群$G$的子群。定义$\H$的左陪集为
  $$
  g\H=\{gh:h\in \H\}
  $$
  其中，元素$g\in G$被称为**代表元**。右陪集的定义类似。

注意：

- $\H$是群，但是一般情况下，陪集$g\H$并不是群，除非$g\in \H$。
- 陪集中任意元素都可以作为代表元

==命题8.1 陪集属性==

- 设$G$是群，$\H$是$G$的子群。任取$g_1,g_2\in G$，则$g_1\H=g_2\H$当且仅当$g_2\in g_1\H$

  ------

  

  - prove: $\Rightarrow:g_1\H=g_2\H$，存在$h_1,h_2\in \H$，则$h_2^{-1}\in \H$，有$g_1h_1=g_2h_2$，根据消去律有：

    $g_2 = g_1h_1h_2^{-1}$。由于$\H$的封闭性，$h_1h_2^{-1}\in \H$。故$g_2=g_1h_1h_2^{-1} \in g_1\H$。

  - $\Leftarrow:$ **欲证$g_1\H = g_2 \H$，即证$g_1\H \subseteq g_2H,g_2\H \subseteq g_1\H$**

    - **先证**$g_1\H \subseteq g_2\H$：任取$g_1h\in g_1\H$，即证：$g_1h \in g_2\H$。

      根据条件:存在$h_1\in \H\ s.t.\ g_2=g_1h_1$，则$g_1=g_2h_1^{-1}$

      $g_1h=(g_2h_1^{-1})h=g_2(h_1^{-1}h)\in g_2\H$，故$g_1\H \subseteq g_2\H$

      - **再证**$g_2\H \in g_1 \H$：任取$g_2h\in g_2\H$，即证：$g_2h\in g_1\H$

        根据条件:存在$h_1\in \H \ s.t.\ g_2=g_1h_1$

        $g_2h=(g_1h_1)h=g_1(h_1h)\in g_1\H$，故$g_2\H \subseteq g_1H$

  - 故$g_1\H=g_2\H$。

==命题8.2 陪集的阶==

- 设$G$是群，$\H$是$G$的子群。对任意$g\in G$，群$\H$的阶与集合$g\H$的阶相同。

==命题8.3 陪集的同一或不相交性==

- 设$G$为群，$\H$是$G$的子群。任取不同的两个群元素$g_1,g_2\in G$，则$g_1\H=g_2\H$或$g_1\H\cap g_2\H = \emptyset$

  ------

  

  - prove: 假设存在$h_1,h_2\in \H$使得$g_1h_1=g_2h_2$，任取$g_1h\in g_1\H$，有：

    $g_1h=g_1(h_1h_1^{-1})h=g_2h_2h_1^{-1}h\in g_2\H$，故$g_1\H \subseteq g_2\H$

    任取$g_2h\in g_2\H$，有$g_2h=g_2(h_2h_2^{-1})h=g_1(h_1h_2^{-1}h)\in g_1\H$，故$g_2\H\subseteq g_1\H$

------

- ==证明两个集合相等的方法==：证$A\subseteq B$且$B\subseteq A$，则$A=B$
  - 其中要证$A\subseteq B$，必须是证：对**任意**的$a\in A$，都有$a\in B$

==命题8.4 群$G$的划分==

- 设$G$是群，$\H$是群$G$的子群。则子群$\H$的所有左陪集将划分群$G$。

==命题8.5 陪集相等关系是一种等价关系==

- 设$G$是群，$\H$是$G$的子群。则子群$H$的所有左陪集的相等关系是这样一种等价关系$\backsim$，即对任意的$g_1,g_2\in G,g_1\backsim g_2$当且仅当$g_1\H=g_2\H$
  - 证明等价的**自反**、**对称**、**传递**三个属性。

==定义8.2 指标==

- 设$G$是群，$\H$是群$G$的子群。$H$在群$G$上的**指标**定义为$\H$在$G$上**不相同的左陪集的个数**，并记为$[G:H]$。

------

e.g. $\H=\{1,3,4,5,9\}$是$Z_{11}^*$的子群。$\H$在$G$有两个左陪集，分别是$\{1,3,4,5,9\}$和$\{2,6,7,8,10\}$，即$[G:H]=2$。

==定理8.1 拉格朗日定理==

- 拉格朗日定理说明：**子群$\H$的阶必然整除群$G$的阶。**

- 因为对于群$G$的子群$\H$来说，所有左陪集$g\H$的阶=$\H$的阶，故有：
  $$
  n\cdot 一个左陪集的阶 = 群G的阶\\
  $$
  这里$n$就是不同左陪集的个数：指标$[G:H]$

  一个左陪集$g\H$的阶=$\H$的阶=$|H|$

  群G的阶=$|G|$

- 设$G$有限群，$H$是$G$的子群，则$|G|/|H|=[G:H]$，即$|G|/|H|$等于$\H$在$G$上不同左陪集的个数。

==推论8.1==

- **设$G$是有限群**，对任意$g\in G$，**$g$的阶必然整除群$G$的阶**，即$ord(g)||G|$。

![image-20231228201229388](C:\Users\27644\AppData\Roaming\Typora\typora-user-images\image-20231228201229388.png)

- 现在推广为：对**任意阶为$n$的群（不一定是循环群）**，其中**任意元素$h$的阶都必整除$n$**

==推论8.2==

- 设$G$是**素数阶有限群**，即$|G|=p$，$p$是素数，则**$G$是循环群**且**任意非单位元元素**$g\in G$是生成元。
  - prove: $\forall g \in G$，有$ord(g)||G|$，有：$ord(g)|p$，因$g\neq e$，故$ord(g)$只能取$p$，故此时$ord(g)=|G|=p$，故任意非单位元元素$g\in G$是群$G$的生成元，故$G$是循环群。

![image-20231228202745932](C:\Users\27644\AppData\Roaming\Typora\typora-user-images\image-20231228202745932.png)

- 现在推广为：只要是**素数阶有限群**，它就是**循环群**且**非单位元元素**$g\in G$​都是生成元。

  ------

  以上两条推论都是从**循环群**推广到**有限群**的。

==推论8.3==

- 设$H$和$K$是有限群$G$的子群，并且$K\sub H \sub G$**(这里说明$K$也是$H$的子群)**，则
  $$
  [G:K]=[G:H][H:K]
  $$

  - prove: $[G:K]=\dfrac{|G|}{|H|}\dfrac{|H|}{|K|}=[G:H][H:K]$

==推论8.4 Fermat小定理==

- 设$p$是素数，$a$是整数且$p\nmid a$。则
  $$
  a^{p-1}\equiv 1\pmod p
  $$

==推论8.5 欧拉定理==

- 设$n$是正合数，$a$是正整数且$gcd(a,n)=1$。则
  $$
  a^{\phi(n)}\equiv 1 \pmod n
  $$

==定理8.2 群论版Fermat小定理==

- $G$是阶为$n$的有限群，则对任意群元$a\in G$，有$a^n=e$

==定理8.3 群论版欧拉定理==

- $G$是阶为$\phi(n)$的有限群，则对任意群元$a\in G$，有$a^{\phi(n)}\equiv 1\pmod n$

------

- 用群论的语言prove：

  - 根据拉格朗日定理，假设$G$为有限群，则对任意群元$a\in G$，都有$ord(a)||G|$

    而$a^{ord(a)}=e$，则必有$a^n=e$

  - 当群$G$为$Z_p^*$时，$|G|=p-1$，对于$a\in Z$且$a\nmid p$，有$a^{p-1}\equiv 1 \pmod p$。证毕

  - 当群$G$为$Z_n^*$时，$|G|=\phi(n)$，对于与$n$互素的正整数$a$，有$a^{\phi(n)}\equiv 1\pmod n$。证毕



## 第九章 同构，同态与商群

==定义9.1 同构==

- 给定群$(G,\cdot)$和群$(H,\circ)$，如果存在一种**双射**$\phi : G\rightarrow H$，使得**群操作得以保持**，即:

  任取$a,b\in G$，
  $$
  \phi(a\cdot b) = \phi(a) \circ \phi(b)
  $$
  称群$G$与群$H$同构，并记为$G\cong H$。**映射$\phi$被称为一种同构映射。**

==命题9.1==

- 设$\phi:G\rightarrow H$从群$G$到群$H$的一种**同构映射**，则以下命题为真：
  - $\phi ^ {-1}:H\rightarrow G$也是同构；
  - $|G|=|H|$
  - 如果$G$是阿贝尔群，则$H$也是阿贝尔群
  - 如果$G$是循环群，则$H$也是循环群
  - 如果$G$有阶为$n$的子群，则$H$也有阶为$n$的子群

==命题9.2==

- 所有无限阶的循环群都同构于群$Z$

  - prove：设群$G$是一个无限阶的循环群，$g$为其生成元。**定义映射$\phi:n\rightarrow g^n$**

    $\forall m,n \in Z, \phi(m+n)=g^{m+n}=g^mg^n=\phi(m)\phi(n)$，群操作得以保持。

    下证$\phi$为双射：因为群$Z$也为无限阶，故满射显然。取$g^m=g^n$，$m\neq n$，由于循环群为无限阶，故不存在$g^m = g^n$，故$m=n$，单射得证。故双射得证。

==命题9.3==

- 如果$G$是阶为$n$的循环群，则$G$同构于$Z_n$。

  - prove: 设群$G$的生成元为$g$，定义映射$\phi:k\rightarrow g^k$且$0\leq k < n$

    $\forall a,b \in Z_n, 0\leq a < n,0\leq b < n$，$\phi(a+b)=g^{a+b}=g^ag^b=\phi(a)\phi(b)$ 

    下证$\phi$为双射：$Z_n =\{0,1,2,\dots n-1\},G=\{g^0,g^1,g^2,\dots g^{n-1}\}$,满射显然

    任取$g^x = g^y,0\leq x <n,0\leq y < n$，则$-n < x-y < n$，又$g^{x-y}=e$，故$x=y$，单射得证。故双射得证。

==推论9.1==

- 如果$G$是阶为$p$的有限群，其中$p$为素数，则$G$同构于$Z_p$

==定义9.2 同态==

- **不要求映射为双射**

- 给定两个群$(G,\cdot)$和$(H,\circ)$，如果存在映射$\phi:G\rightarrow H$使得对**任意**的$a,b\in G$，**群操作得以保持**，即：
  $$
  \phi(a\cdot b)=\phi(a)\circ\phi(b)
  $$
  则称群$(G,\cdot)$**同态于群**$(H,\circ)$。映射$\phi$被称为**同态映射**。

==定义9.3 正规子群==

- 群$H$是群$G$的子群。如果对**任意**$g\in G$，有$gH=Hg$，则称$H$是群$G$的正规子群。
- 等式 $gH=Hg$ 意味着对**任意的$g\in G$和$h\in H$**，**存在**$h'\in H$使得$gh=h'g$

==命题9.5==

- 设$G$是群，$H$是$G$的子群。以下命题等价。

  - 子群$H$是$G$的正规子群，即对任意$g\in G,gH=Hg$。

  - 对任意$g\in G$，有$gHg^{-1}=H$

    ------

    

    - prove:即证对任意的$g\in G$，有$gHg^{-1}\subseteq H$且$H\subseteq gHg^{-1}$。

      - 因为子群$H$是$G$的正规子群，所以对任意的$g\in G, h\in H$，存在$h'$使得$gh = h'g$

        根据消去律有：$ghg^{-1}=h'\in H$，故有$gHg^{-1}\subseteq H$

        任取$h\in H$，存在$h'$使得$gh=h'g$，根据消去律有：$h = g^{-1}h'g=g^{-1}h'(g^{-1})^{-1} \in gHg^{-1}$

        故有$H\subseteq gHg^{-1}$

      综上:$gHg^{-1}=H$ 证毕。

    - prove: 对任意$g\in G$，有$gHg^{-1} = H$，对任意的$h\in H$，存在$h'$使得$ghg^{-1}=h'$

    - 根据消去律有：$gh=h'g \in Hg$，故$gH\subseteq Hg$

      对任意的$h\in H$，存在$h'$使得$h=gh'g^{-1}$，根据消去律：$hg=gh'\in gH$，故$Hg\subseteq gH$

      综上：$gH=Hg$ 证毕。

==命题9.6==

- 设$\phi:G_1\rightarrow G_2$为一种从群$G_1$到群$G_2$的群同态映射，则以下命题为真

  - 如果$e$是$G_1$的单位元，则$\phi(e)$是$G_2$的单位元。
  - 对任意群元$g\in G_1$，$\phi(g^{-1})=[\phi(g)]^{-1}$
  - 如果$H_1$是$G_1$的子群，则$\phi(H_1)$是$G_2$的子群
  - 如果$H_2$是$G_2$的子群，则$\phi(H_2)^{-1}=\{g\in G_1:\phi(g)\in H_2\}$是群$G_1$的子群。而且，如果$H_2$是$G_2$的正规子群，则$\phi(H_2)^{-1}$是$G_1$的正规子群。

- prove:

  1. 假设$e$为$G_1$的单位元，$e'$为$G_2$的单位元。则有$\phi(e)e'=\phi(e)=\phi(ee)=\phi(e)\phi(e)$，根据消去律有：

     $\phi(e) = e'$。故$\phi(e)$为$G_2$的单位元

==定义9.4 Kernel==

- 设$\phi:G\rightarrow H$是一种群同态映射，$e$是群$H$的单位元。**$\phi^{-1}({e})$是$G$的子群**，**该子群称为$\phi$的$Kernel$，记为$Ker\phi$**

==命题9.7 Kernel==

- 设$\phi:G\rightarrow H$是一种群同态映射，则$\phi$的$Kernel$是$G$的正规子群。
  - 因为在群$H$中，$\{e\}$为平凡子群，是正规子群。
  - 故$\phi^{-1}(\{e\})$也是$G$的正规子群。

==定理9.2 商群==

- 如果**群$H$是群$G$的正规子群**，则$H$在$G$中的陪集形成一个群$G/H$，群操作是$(aH)(bH)=(abH)$。

  此群$G/H$被称为**$G$在$H$上的商群**

- 若群$H$是群$G$的正规子群，则$H$在群$G$的陪集形成商群$G/H$，且群的阶为$[G:H]$（不同的左陪集的个数）

------

要证明$G/H$是一个群：

- 先理解群操作$$(aH)(bH)=(abH)$$含义
- 其次证明群操作是一种**良定义操作**
- 最后验证群公理

==引理9.1 理解商群群操作== 

- 群$H$是群$G$的**正规子群**，群$H$的**任意两个陪集$aH$和$bH$的乘积**依然**是一个陪集**，即$(aH)(bH)=(abH)$。

  - prove: 因为$H$是群$G$正规子群，所以对任意$a\in G$都有$aH=Ha$

    又因为$H$是群，满足封闭性，故$HH=H$

    有：$(aH)(bH)=(Ha)(bH)=(abH)H=abH$

==引理9.2 商群操作的良定义性==

- $G/H$中的群操作是一种良定义操作，即如果对任意的群元$a,b,c,d\in G$，有$aH=bH$且$cH=dH$，则有：
  $$
  (aH)(cH)=acH=bdH=(bH)(dH)
  $$

  - prove：因为$aH=bH$，$cH=dH$，由于对于任意$h\in H$，存在$h'$使得$ah=bh'$，这里直接取$h=e$，故存在$n_1,n_2 \in H$使得$a=bn_1,c=dn_2$，则有
    $$
    (aH)(cH)=acH=bn_1dn_2H=bn_1dH=bn_1Hd=bHd=bdH=(bH)(dH)
    $$

- 验证群公理：封闭性:$(aH)(bH)=(abH) \in G/H$

  结合律显然，单位元为$eH=H$，$aH$的逆元为$a^{-1}H$。群的阶为不同左陪集的个数$[G:H]$

------



- $G/H=\{g_1H,g_2H,\dots,g_nH\}$，对于所有$g^{i} \in G$。可理解为**商群$G/H$就是陪集$gH$的集合，当然$H$要为$G$的正规子群**

- ==两种平凡商群==
  - 商群$G/G$同构于平凡子群$\{e\}$。
  - 商群$G/\{e\}$同构于群$G$

==定义9.5 标准同态==

- 设$H$是群$G$的**正规子群**，定义同态映射$\phi:G\rightarrow G/H$为$\phi(g):H\rightarrow gH$，$\forall g \in G$。并称该映射为**标准同态**或者**自然同态**，且$Ker\phi = H$。
  - prove: $\phi(g_1g_2)=g_1g_2H=g_1Hg_2H=\phi(g_1)\phi(g_2)$

==定理9.3 第一同构定理==

-  如果$\psi:G\rightarrow H$是一种群同态映射，且$K=Ker\psi$，则$K$是$G$的正规子群。设$\phi:G\rightarrow G/K$是标准同态，则存在**唯一同构映射**$\eta:G/K \rightarrow \psi(G)$使得$\psi=\eta \phi$，即$\psi$是$\eta$和$\phi$的复合映射。

  ![90c3577bda96b67ba4e55d96e78eeab](D:\WeChat Files\wxid_6o0uvsbjr4sb12\FileStorage\Temp\90c3577bda96b67ba4e55d96e78eeab.jpg)
  
  - 证明：
  
    - 第一步：构造法，先构造一个同态映射$\eta:G/K\rightarrow \psi(G)$为$\eta(gK)=\psi(g)$
    - 第二步：证明映射$\eta$是良定义映射。
    - 第三步：证明映射$\eta$是同态且是双射，即为同构映射。
  
    ------
  
    2.证明$\eta$是良定义映射，即证明如果对于两个不同的$g_1,g_2 \in G$，有$g_1K=g_2K$，则$\eta(g_1K)=\eta(g_2K)$。因为$g_1K=g_2K$，则存在$k \in K$使得$g_1 = g_2k$。由于$K$中的所有元素都映射到$\psi(G)$的单位元上，故$\eta(g_1K)=\psi(g_1)=\psi(g_2k)=\psi(g_2)\psi(k)=\psi(g_2)=\eta(g_2K)$
  
    3.证明$\eta$是同态且是双射：
  
    $\eta(g_1Kg_2K)=\eta(g_1g_2K)=\psi(g_1g_2)=\psi(g_1)\psi(g_2)=\eta(g_1K)\eta(g_2K)$，群操作得以保持
  
    下证双射：满射显然，任取$g_1K,g_2K$，假设$\eta(g_1K)=\eta(g_2K)$，即$\psi(g_1)=\psi(g_2)$，即证$g_1K=g_2K$
  
    $\psi(g_1)=\psi(g_2g_2^{-1}g_1)=\psi(g_2)\psi(g_2^{-1}g_1)$，而$g_2^{-1}g_1 \in K$，故$\psi(g_2^{-1}g_1) $是单位元。故$\psi(g_1)=\psi(g_2)\psi(g_2^{-1}g_1)=\psi(g_2)$，单射得证。故双射得证。
    
    
    
    

## 第十章 中国剩余定理

==定理10.1 中国剩余定理$(Chinese\ Remainder\ Theorem)$==

- 设$p$和$q$是**互素**的两个正整数，$n=pq$。对任意的$a\in Z_p$和$b\in Z_q$，存在唯一解$x,0\leq x < n$使得：
  $$
  x\equiv a\pmod p\\
  x\equiv b \pmod q
  $$

  - **唯一解为：**$x=aqq^{-1}+bpp^{-1} \pmod n$
  - 其中$qq^{-1}\equiv 1 \pmod p,\ pp^{-1}\equiv 1 \pmod q$
  - **用egcd求逆元$q^{-1}$和逆元$p^{-1}$**
    - 证明存在唯一解$x$：假设存在$y\neq x$是另一个解
    - 将$y$和$x$理解为$a+kp$的形式，故存在$t\in N$使得$(y-x)=tp$
    - 将$y$和$x$理解为$b+kq$的形式，故存在$s\in N$使得$(y-x)=sq$
    - 故$tp=sq$，又因为$p$和$q$互素，$t$的因子中必含$q$，$s$的因子中必含$p$。
    - 故存在$k\in N$必有$(y-x)=kpq$，故$(y-x)\equiv 0 \pmod {pq}$，故$y=x$

==定理10.2 中国剩余定理推广版==

- 设$m_0,m_1,\dots,m_{n-1}$是**两两互素**的整数，对以下$n$个同余式的同余方程组
  $$
  x\equiv a_0\pmod {m_0}\\
  \dots\\
  x\equiv a_{n-1} \pmod {m_{n-1}}
  $$
  存在模$M$的**唯一解**，其中$M=m_0m_1\dots m_{n-1}$

  - 令$M=\prod _{i=0} ^{n-1}$，记$b_i = M/m_i$。存在$b_i^{-1}$使得$b_ib_i^{-1} \equiv 1 \pmod {m_i}$。

  - 则**唯一解为:**
    $$
    x = \sum  _{i=0} ^{n-1}a_ib_ib_i^{-1} \pmod M
    $$

==定理10.3 斌头剩余定理==

- 设$p$和$q$是**不等的两个素数**，$n=pq$。对任意的$a\in Z_p$和$b\in Z_q$，存在唯一解$x,0\leq x < n$使得：
  $$
  x\equiv a \pmod p\\
  x\equiv b \pmod q
  $$

- **唯一解为：** $x=aq^{p-1} + bp ^{q-1} \pmod n$

==定理10.4 中国剩余定理的代数版本==

- 设$n=pq$， $p>1$和$q>1$是两个**互素的正整数**。则
  $$
  Z_n \cong Z_p \times Z_q \ \ 且\ \ Z_n^* \cong Z_p^*\times Z_q^*
  $$

  > - 思想：设$n=pq$，$p$和$q$是两个互素的正整数。给定一个任意正整数$x$，它可以表达为一个唯一的序对:$([x\ mod\ p],[x\ mod \ q])$。
  >
  > - 证明：
  >
  >   1. 定义从$Z_n$到$Z_p \times Z_q$的映射$\phi$为：$\phi(x)=([x\ mod\ p],[x\ mod\ q])$
  >
  >   2. 证明映射$\phi$是一种双射。满射显然，因为根据CRT，**任意序对中**的两个同余式在模$n$下有**唯一解**。
  >
  >      证明单射：取$\phi(a)=\phi(b)$，即$([a\ mod\ p],[a\ mod\ q]) =([b\ mod \ p],[b\ mod \ q])$，又因$a,b$均落在区间$[0,n)$中，故$a=b$。
  >
  >   3. 证明映射$\phi$是同态映射：
  >      $$
  >      \phi(a+b)=([(a+b)\ mod\ p],[(a+b)\ mod\ q)])=\dots=\phi(a)+\phi(b)
  >      $$
  >      群操作得以保持。综上：映射$\phi$是双射，故$Z_n \cong Z_p \times Z_q$

------

e.g. 求$2^{2020}$的最后两数位

- 即求$2^{2020}\ mod\ 100$，$100 = 4 \times 25$。故$2^{2020} \leftrightarrow (2,2)^{2020}=(2^{2020}\ mod\ 4,2^{2020}\ mod\ 25)=(0,1)$

- ==注意！==$(0,1)\neq 0\times4+1\times 25$

- 此时相当于求
  $$
  x\equiv 0\pmod 4\\
  x\equiv 1\pmod {25}
  $$

  - 即求$x=0\times 25 \times 25^{-1}+1\times 4 \times 4^{-1} \pmod {100}$

  - 此时逆元$25^{-1}$和$4^{-1}$用**egcd**求得：
    $$
    \begin{pmatrix}
       1 & 0 & 4 \\
       0 & 1 & 25 \\
       6 & 0 & 24 \\
       -6 & 1 & 1 \\
       -18 & 3 & 3\\
       19 & -3 & 1
      \end{pmatrix}
    $$
    故$25^{-1} = 1$，$4^{-1} = 19$

    代入解得：$x = 76 \pmod {100} = 76$，故最后两数位为76

------

e.g. 求同余方程组
$$
x\equiv	1\ (mod\ 5)\\
x\equiv	2\ (mod\ 7)\\
x\equiv	3\ (mod\ 9)\\
x\equiv	4\ (mod\ 11)
$$
解：令$M=5\times 7 \times 9 \times 11= 3465$，记$b_i = M/m_i$，其中$i\in \{0,1,2,3\}$

可得：$b_0 = 693,b_1 = 495,b_2=385,b_3 = 315$

下求$b_i^{-1}$使得$b_ib_i^{-1} \equiv 1 \pmod {m_i}$
$$
\begin{pmatrix}
1 & 0 & 693\\
0 & 1 & 5\\
0 & 138 & 690 \\
1 & -138 & 3\\
2 & -276 & 6\\
2 & -277 & 1
\end{pmatrix}
\begin{pmatrix}
1 & 0 & 495\\
0 & 1 & 7\\
0 & 70 & 490\\
1 & -70 & 5\\
-1 & 71 & 2\\
-2 & 142 & 4\\
3 & -212 & 1\\
\end{pmatrix}
\begin{pmatrix}
1 & 0 & 385 \\
0 & 1 & 9\\
0 & 42 & 378\\
1 & -42 & 7\\
-1 & 43 & 2\\
-3 & 129 & 6\\
4 & -171 & 1\\
\end{pmatrix}
\begin{pmatrix}
1 & 0 & 315\\
0 & 1 & 11\\
0 & 28 & 308\\
1 & -28 & 7\\
-1 & 29 & 4\\
2 & -57 & 3\\
8 & -228 & 12\\
8 & -229 & 1\\
\end{pmatrix}
$$
可得：$b_0^{-1} = 2,b_1^{-1}=3,b_2^{-1}=4,b_3^{-1}=8$

故存在唯一解$x=\prod _{i=0} ^ {3}a_ib_ib_i^{-1}\pmod M=(1\times693\times2+2\times495\times3+3\times385\times4+4\times315\times8)\pmod {3456}$

解得$x=1731$



## 第十一章 二次剩余

==命题11.1==

- 设$p$是一个奇素数，$b$是不被$p$整除的整数。则同余式：
  $$
  x^2\equiv b \pmod p
  $$
  或者**没有解**，或者**有且仅有两个模$p$非同余解**

==定义11.1 二次剩余==

- 设$m,n\in Z$，且$gcd(m,n) = 1$。如果存在$x\in Z$，使得$m\equiv x^2 \pmod n$，则称$m$为模$n$的二次剩余$(\mathbf{QR})$，否则称$m$为模$n$的二次非剩余$(\mathbf{QNR})$。
  - 我们在这里**只考虑模素数下的二次剩余**

==定理11.1==

- 设$p$为奇素数，则刚好存在$(p-1)/2$个模$p$的$\mathbf{QR}$和$(p-1)/2$个模$p$的$\mathbf{QNR}$。
  - 也就是$Z_p^*$中恰有$(p-1)/2$个$\mathbf{QR}$和$(p-1)/2$个$\mathbf{QNR}$

==命题11.2==

- 用$QR_p$表示模$p$的$\mathbf{QR}$的集合，$QR_p$在乘法上成群。

  - > ==对定理11.1的证明==：从$Z_p^*$到$QR_p$的映射$\phi$定义为：$\forall a\in Z_p^*, a\rightarrow a^2$。$\phi(ab)=(ab)^2=a^2b^2=\phi(a)\phi(b)$
    >
    > 群操作得以保持，故映射$\phi$为同态映射。故我们可以找到$Ker\phi = \{1,p-1\}$，作商群$Z_p^*/Ker\phi$，又因$Ker\phi$是$Z_p^*$的正规子群，故映射$\eta : Z_p^*\rightarrow Z_p^*/Ker\phi$为标准同态，则根据第一同构定理，有$Z_p^*/Ker\phi \cong QR_p$。故$|QR_p|=|Z_p^* / Ker\phi|=|Z^*_p|/|Ker\phi|=\dfrac{p-1}{2}$

==命题11.3==

- 设$p$为奇素数，则

  1. 两个模$p$的$\mathbf{QR}$相乘得到一个$\mathbf{QR}$，记为：
     $$
     \mathbf{QR} \times \mathbf{QR} = \mathbf{QR}
     $$

  2. 一个模$p$的$\mathbf{QR}$和一个模$p$的$\mathbf{QNR}$相乘得到一个模$p$的$\mathbf{QNR}$，记为：
     $$
     \mathbf{QR} \times \mathbf{QNR} = \mathbf{QNR}
     $$

  3. 两个模$p$的$\mathbf{QNR}$相乘得到一个$\mathbf{QR}$，记为：
     $$
     \mathbf{QNR} \times \mathbf{QNR} = \mathbf{QR}
     $$

------

> 证明：
>
> - 由于$QR_p$是一种乘法群，根据封闭性必有：$\mathbf{QR} \times \mathbf{QR} = \mathbf{QR}$
>
> - 设$b$是一个$\mathbf{QNR}$,$a$是一个$\mathbf{QR}$，则存在$a_1\in Z$使得$a\equiv a_1^2 \pmod p$。如果$ab$是一个$QR$，则存在$c$使得$ab\equiv c^2\pmod p$，则有$c^2 \equiv ab \equiv a_1^2b \pmod p$，已知$a_1$与$p$互素，则存在$a_1^{-1} \in Z$使得$a_1a_1^{-1} \equiv 1 \pmod p$，根据消去律有：$c^2(a_1^{-1})^2\equiv b \pmod p$，$b$此时是$\mathbf{QR}$,与假设矛盾。故$ab$是一个$\mathbf{QNR}$。故$\mathbf{QR} \times \mathbf{QNR} = \mathbf{QNR}$
>
> - 设$a$是一个$\mathbf{QNR}$，且$p \nmid a$，则根据群的性质可知：
>   $$
>   aZ_p^*=Z_p^*
>   $$
>   我们知道$Z_p^*$中恰有$(p-1)/2$个$\mathbf{QR}$和$(p-1)/2$个$\mathbf{QNR}$，根据$a \times \mathbf{QR} = \mathbf{QNR}$，所以用$(p-1)/2$个$QR$去乘$a$会得到$(p-1)/2$个$\mathbf{QNR}$，故用剩下的$QNR$去乘$a$，必定会落在$\mathbf{QR}$上。故$\mathbf{QNR}\times \mathbf{QNR} = \mathbf{QR}$
>



==定义11.2 勒让德符号==

- 设$p$是一个奇素数，并设$n\in Z$。定义勒让德符号$(\dfrac{a}{p})$为：
  $$
  (\dfrac{a}{p})= \begin{cases} 1 & \text{若a是模p的QR}\\
  -1 & \text{若a是模p的QNR}\\
  0 & \text{若p|a}
  \end {cases}
  $$
  

==命题11.4 勒让德符号的若干属性==

- 设$p$是奇素数，$a,b\in Z$且不被$p$整除。则有：
  1. 如果$a\equiv b \pmod p$，则$(\dfrac ap)=(\dfrac bp)$
  2. $(\dfrac ap)(\dfrac bp)= (\dfrac{ab}{p})$
  3. $(\dfrac{a^2}{p})=1$

==定理11.2 欧拉准则==

- 设$p$是奇素数，$a\in Z$，且$gcd(a,p) = 1$。那么，
  $$
  (\dfrac ap)\equiv a^{(p-1)/2} \pmod p
  $$

  > - 假设$(\dfrac ap) = 1$，即存在$x\in Z$使得$x^2\equiv a \pmod p$，而根据Fermat小定理：$x^{p-1} \equiv 1 \pmod p$，等价于$x^{((p-1)/2)\times2} \equiv a^{(p-1)/2}\equiv 1 \pmod p$，故$(\dfrac ap) \equiv a^{(p-1)/2}\equiv 1\pmod p$
  > - 假设$(\dfrac ap)=-1$，则不存在$x\in Z$使得$x^2 \equiv a \pmod p$，故$a^{(p-1)/2} - 1\not \equiv 0 \pmod p$，根据Fermat小定理，$a^{p-1} - 1\equiv 0 \pmod p$，而$a^{p-1} - 1 \equiv (a^{(p-1)/2}-1)(a^{(p-1)/2}+1) \equiv 0 \pmod p$，则$a^{(p-1)/2} + 1 = 0$，故$a^{(p-1)/2}\equiv (\dfrac ap)\equiv-1 \pmod p$

==推论11.1==

- 设$p$是一个奇素数，则
  $$
  (\dfrac{-1}{p}) = \begin{cases} 1 & 如果p\equiv 1 \pmod 4 \\
  -1 & 如果p\equiv -1\pmod 4
  \end{cases}
  $$

  > - 证明：$(\dfrac{-1}p)= (-1)^{(p-1)/2}$
  > - 当$p\equiv 1 \pmod 4$时，$\exists k \in Z$使得$p = 4k +1$，则$(\dfrac{-1}p)= (-1)^{(p-1)/2}=(-1)^{2k}=1$
  > - 当$p\equiv -1 \pmod 4$时，$\exists k \in Z$使得$p = 4k +3$，则$(\dfrac{-1}p)= (-1)^{(p-1)/2}=(-1)^{2k+1}=-1$

==命题11.5 模4余1的素数==

- 模4余1的素数有无穷多。

==定理11.3 二次互反律 版本1==

- 设 $p,q$是两个不同的奇素数，则
  $$
  (\dfrac {-1}{p})=\begin{cases} 1 & 如果p\equiv 1 \pmod 4 \\
  -1 & 如果p\equiv -1 \pmod 4
  \end {cases}\\
  \\
  
  (\dfrac 2 p)=\begin{cases} 1 & 如果p\equiv 1或7\pmod 8\\
  -1 & 如果p\equiv 3或 5 \pmod 8
  \end{cases}\\
  \\
  (\dfrac qp)=\begin{cases} (\dfrac pq) & 如果p\equiv 1 \pmod 4或q\equiv 1 \pmod 4\\
  -(\dfrac pq) & 如果p\equiv q \equiv 3\pmod 4
  \end{cases}
  $$

==定理11.4 二次互反律 版本2==

- 设$p,q$是两个不同的奇素数，则
  $$
  (\dfrac pq)(\dfrac qp)= (-1)^{((p-1)/2)(q-1/2))}
  $$



## 第十二章 环与域

- 环是一种包括**两种二元操作的代数结构**

==定义12.1 环==

- 环$R$是一个非空集合，在$R$上有**两种封闭**的**二元操作**:加法(记为$+:R\times R\rightarrow R$)和乘法(记为$*:R\times R \rightarrow R$)，并且满足以下条件：
  1. 在加法$(+)$上$R$是一个**阿贝尔群**，加法的单位元记为$0$，加法上的逆元记为$-a$。
  2. $R$在**乘法$(*)$**上满足**结合律**。
  3. **乘法**在加法上满足**分配律**。 

- **理解：**==环：一个加法阿贝尔群+乘法满足结合律+乘法对加法满足分配律==

- **交换环：**若环$R$在乘法上满足交换律：$a*b=b*a$，则称为交换环，否则称为非交换环。

- **不特别声明都假定环带乘法的单位元。**

  ------

  

- **平凡环（零环）：**$R=\{0\}$是只有一个元素的最小环
- **一个最小的非平凡环：**$R=\{0,1\}$，或者记为$\Z_2$
- **$Z_n$的元素在乘法上不一定存在逆元**
- **$Z_p$的所有非零元素在乘法上都有逆元**

==命题12.1 环的一些性质==

- 设$R$是一个环，且$a,b\in R$，则有：

  1. $a0=0a=0$
  2. $a(-b)=(-a)b=-ab$
  3. $(-a)(-b)=ab$

  > - 证明：根据分配律：$a(0+0)=a0+a0=0$，故$a0=0$，同理：$(0+0)a=0a+0a=0$，故$0a=0$。故$a0=0a=0$
  > - 证明：$ab+a(-b)=a(b+(-b))=a0=0$，故根据消去律：$a(-b)=-(ab)$，同理：$ab+(-a)b=(a+(-a))b=0b=0$，故根据消去律：$(-a)b=-(ab)$，故$a(-b)=(-a)b=-ab$
  > - 证明：根据2.：$(-a)(-b)=-(-a)b=-(-ab)=ab$

------

- **环并不要求环元素在乘法上存在逆元，一个直接的结论就是：在乘法上，消去律不必然存在！**

==定义12.2 整环==

- 给定一个环$R$，对**非零元素**$a\in R$，如果存在**非零元素**$b\in R$，且$a*b=0$，则称$a$为一个**零因子**。如果**交换环$R$**中**没有零因子**，即任取$a,b\in R$，如果$ab=0$则有$a=0$或$b=0$,则称$R$为**整环**。

- 零因子不包括$0$
- 两个**非零元素相乘为0**，则**互为零因子**

==命题12.2 整环的消去律==

- 设$D$是一个交换环，$D$是整环**当且仅当**对**任意元素**$a,b,c\in D$，且$a\neq 0$，若$ab=ac$，则$b=c$。

- ==整环 = 交换环 + 乘法消去律==

- 整环必是**交换环**。

==定义12.3 子环==

- 给定环$R$，$R'$是$R$的子集，**如果$R'$在环$R$的加法和乘法上也形成环**，则称$R'$是$R$的子环，记为$R'\sub R$
  - 偶数环是整数环的子环，即$2\Z\sub\Z$。由此可知：**子环并不自然继承母环的乘法单位元**

==命题12.3==

- 给定环$R$，$R'$是$R$的子集。$R'$是$R$的子环，当且仅当以下条件满足：

  1. $R'=\emptyset$
  2. $\forall a,b\in R'$，有$ab\in R'$
  3. $\forall a,b\in R'$，有$a-b\in R'$

  > - 证明$\Leftarrow$：根据命题6.9 群$G$的非空子集$H$是$G$的子群，当且仅当对任意$a,b\in H,ab^{-1}\in H$
  > - 思路：由于$R'$是环$R$的**非空**子集，**$R'$必然继承了环$R$中乘法的结合律与乘法对加法的分配律**，现只需证$R'$满足**乘法封闭性**和**$R'$在加法上是环$R$的子群**即可。
  > - 乘法封闭性：$\forall a,b\in R'$，有$ab\in R'$
  > - $R'$是环$R$在加法上的子群：$\forall a,b \in R'$，有$a-b\in R'$，$-b$为$b$在加法上的逆元。取$b=a$，则$a-b=0\in R'$，$R'$上存在单位元。$a+b=a-(-b) \in R'$，满足封闭性。结合律显然。故$R'$是$R$的子环。

==定义12.4 环同态与环同构==

- 给定两个环$R$和$R'$，若映射$\phi:R\rightarrow R'$满足：$\forall a,b\in R$，
  $$
  \phi(a+b)=\phi(a)+\phi(b)\\
  \phi(ab)=\phi(a)\phi(b)
  $$
  则称$\phi$为环同态。如果$\phi$是一种双射，则$\phi$是环同构。

  **环同态$\phi$的$Kernel$定义为以下集合：$Ker\phi=\{r\in R:\phi(r)=0\}$。**

  即**所有通过$\phi$映射到加法群单位元$0$上的元素**所构成的集合

==命题12.4 环同态的性质==

- 设映射$\phi:R\rightarrow R'$是环同态，则：

  1. 如果$R$是交换环，则$\phi(R)$也是交换环。

  2. 分别记$0$和$0'$是$R$和$R'$的加法单位元，$\phi(0)=0'$

  3. 分别记$1$和$1'$是$R$和$R'$的乘法单位元，**如果$\phi$是满射，则$\phi(1)=1'$​**

     ------

     

- **零同态**：把任意环$R$映射到零环$\{0\}$的环同态。

- 在环的语境下与群论的**正规子群**对应的一个概念：**理想**。

==定义12.5 理想==

- 给定环$R$，$I$是$R$的**子环**，如果对任意的$r\in R$有$rI\sub I$和$Ir\sub I$，则称$I$是$R$的理想。

- 如果$I$是$R$的理想，又是$R$的真子集，则称$I$是$R$​的真理想。

  ------

  

- 条件可弱化为：**$I$是$R$加法群的子群**，对于$r\in R$，左乘$I$、右乘$I$都会落在$I$中。

- 理想具有**吸收性**：对任意的环元素$r\in R$，无论它是否落在$I$中，用$r$左乘$I$或者右乘$I$，所得到的元素都会落回到$I$中。
- 换一种形式说：对**任意**的$r\in R$和**任意**的$i\in I$，必然有$ri\in I$和$ir\in I$

> 区分：正规子群中$gH=Hg$是对**任意**的$g \in G$，**任意**的$h\in H$，都**存在**$h'\in H$使得$gh=h'g$。

- 所有环$R$都有两个平凡理想：$\{0\}$和$R$。
- 对任意整数$n\in Z$，集合$nZ$是环$Z$的理想。（此时集合$nZ$中不必然有单位元$1$，也不必然有乘法逆元)

==命题12.5 主理想==

- 设$R$是一个**交换环**且**有单位元**，**任取$a\in Z$**，定义集合
  $$
  <a>\triangleq \{ar:r\in R\}
  $$
  可验证$<a>$是环$R$的一个理想，并称之为**主理想**。

  - 主理想：==交换环+有乘法单位元+任取一个整数乘环$R$中的元素的结果所构成的集合==

> 证明$<a>$是理想：
>
> - 首先验证$<a>$是非空集合，至少包括$0$和$a$两个元素。
> - 其次验证$<a>$在加法上成群。
> - 最后验证$<a>$具有吸收性。任取$s\in R$乘上$<a>$中的任意元素$ar$，都有$s(ar)=a(sr)\in <a>$

- 对任意环$R$，只包含一个元素$0$的主理想$<0>$称为**零理想**。
- 对任意带单位元的环$R$，称$<1>$为单位理想，显然$R=<1>$
- 对任意整数$n$，集合$nZ$是整数环$Z$的理想，也是主理想，$nZ=<n>$

==命题12.6==

- 整数环$Z$的所有理想都是主理想。

==命题12.7==

- 环同态$\phi:R\rightarrow R'$的$Kernel$是$R$的理想。

------

==商环加法==

- 一个环$R$，本身在加法上是阿贝尔群，而其理想$I$则是$R$的正规加法子群。

- 因此$R/I$在加法上就是一个商群，其中元素就是加法上$I$的陪集。比如任取$r\in R$，$r+I$就是$R/I$中的群元素。（类似于陪集）

- 故商群$R/I$的群操作为：$\forall r,s \in R$，
  $$
  (r+I)+(s+I)=(r+s)+I
  $$

==引理12.1 商环乘法==

- 设$R$是环，$I$是$R$中的理想。商群$R/I$中元素的乘法定义为：对任意的群元$r,s\in R$，
  $$
  (r+I)(s+I)=(rs+I)
  $$
  该乘法是一种良定义操作，且具有封闭性、结合律和对加法具有分配律。

- 要证明乘法是一种良定义操作，就是要证明乘法独立于陪集代表元的选择。即证明，如果$r+I=r'+I$，$s+I=s'+I$。根据乘法定义，即要证$rs+I=r's'+I$，即证明$r's' \in rs +I$
  - 因为$r+I=r'+I$，$s+I=s'+I$。故存在$i_1,i_2 \in I$使得$r=r'+i_1,s=s'+i_2$。$r's'=(r-i_1)(s-i_2)=rs-ri_2-si_1+i_1i_2$，由于商环的吸收性，故$-ri_2-si_1+i_1i_2 \in I$，故$r's'\in rs+I$，证毕。

==定理12.2 商环==

- 设$R$是环，$I$是$R$中的理想。商群$R/I$在陪集加法与引理12.1中定义的乘法上形成环，称为$R$模$I$的商环，同样记为$R/I$。

==定义12.6 环的标准同态==

- **设$I$是环$R$的理想**，定义环同态映射$\phi:R\rightarrow R/I$为：对任意$r\in R,\phi(r)=r+I$。并称该映射为环的标准同态或者自然同态，且$Ker\phi = I$

==定理12.3 第一同构定理==

- 设$\psi:R\rightarrow S$是环同态，记$K=Ker\psi$是$R$的理想。如果$\phi:R\rightarrow R/K$是标准同态，则存在**唯一同构**$\eta:R/K \rightarrow \psi(R)$使得$\psi = \eta\phi$。

==定义12.8 特征==

- 环$R$的特征定义为**最小正整数$n$**使得对**任意的$r\in R$**，$\underbrace{r+r+\dots+r}_{n个}=nr=0$。如果不存在这样的$n$，则$R$的特征定义为$0$。
  - 环$Q,R,C$的特征都是$0$。

==引理12.2==

- 设$R$为带乘法单位元的环，若$1$在加法群的阶为$n$，则$R$的特征为$n$。
  - prove: 因为$n$是最小正整数使得$n1=0$，任取$r\in R$，都有$nr=n(1r)=(n1)r=0$，故$R$的特征为$n$

==命题12.10==

- 整环的特征或者为素数，或者为$0$。

==定义12.9 极大理想和素理想==

- **真理想：**设$R$是环，$M$是$R$的真子集且是$R$的理想，则称$M$是$R$的真理想。
- **极大理想：**设$M$是环$R$的**真理想**，如果$M$不是$R$的**任意真理想的真子集**，则称$M$是**极大理想**。
  - 即如果$M$是$R$的极大理想，则对$R$的任意理想$I$，若$M\sub I$，则$I=R$。 
- **素理想：**设$P$是**交换环$R$**的**真理想**，如果对任意$ab\in P$，则$a\in P$，或$b\in P$，就称$P$为素理想。

==定理12.5 素理想与整环==

- 设$R$是带单位元的交换环，$P$是$R$的理想，则$P$是$R$的素理想，当且仅当$R/P$是整环。

==推论12.1 极大理想与素理想==

- 交换环的每一个极大理想都是素理想。
